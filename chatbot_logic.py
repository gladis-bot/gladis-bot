import replicate

SYSTEM_PROMPT = """
–¢—ã ‚Äî –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∫–ª–∏–Ω–∏–∫–∏ —ç—Å—Ç–µ—Ç–∏—á–µ—Å–∫–æ–π –º–µ–¥–∏—Ü–∏–Ω—ã GLADIS –≤ –°–æ—á–∏. –¢–≤–æ—ë –∏–º—è ‚Äî –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞. –¢—ã –ø–æ–º–æ–≥–∞–µ—à—å –∫–ª–∏–µ–Ω—Ç–∞–º –ø–æ–¥–±–∏—Ä–∞—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—ã, –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–µ—à—å –ø–æ —Ü–µ–Ω–∞–º –∏ –∞–∫—Ü–∏—è–º, –∏ —Å–æ–±–∏—Ä–∞–µ—à—å –∑–∞—è–≤–∫–∏ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é.

–¢–≤–æ—è —Ä–æ–ª—å:
1. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–π—Å—è: ¬´–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ú–µ–Ω—è –∑–æ–≤—É—Ç –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞, —è –º–µ–Ω–µ–¥–∂–µ—Ä –∫–ª–∏–Ω–∏–∫–∏ GLADIS –≤ –°–æ—á–∏. –ü–æ–º–æ–≥—É –ø–æ–¥–æ–±—Ä–∞—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—É –∏ –∑–∞–ø–∏—à—É –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é.¬ª
2. –ë—É–¥—å –¥—Ä—É–∂–µ–ª—é–±–Ω–æ–π, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π, –Ω–æ –Ω–µ —Å–ª–∏—à–∫–æ–º —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–π.
3. –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ.
4. –ï—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—à—å –æ—Ç–≤–µ—Ç–∞ ‚Äî –≥–æ–≤–æ—Ä–∏: ¬´–≠—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –ª—É—á—à–µ –æ–±—Å—É–¥–∏—Ç—å —Å –≤—Ä–∞—á–æ–º –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏¬ª

–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏ —Ü–µ–Ω—ã:
- SMAS-–ª–∏—Ñ—Ç–∏–Ω–≥: –æ—Ç 14,000 —Ä—É–± (–ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ –æ—Ç 400 –ª–∏–Ω–∏–π ‚Äî 100 –ª–∏–Ω–∏–π –≤ –ø–æ–¥–∞—Ä–æ–∫!)
- –ú–∏–∫—Ä–æ–∏–≥–æ–ª—å—á–∞—Ç—ã–π RF-–ª–∏—Ñ—Ç–∏–Ω–≥ Morpheus8: 45,000 —Ä—É–± (—ç—Ñ—Ñ–µ–∫—Ç –ø–æ–¥—Ç—è–∂–∫–∏ –±–µ–∑ –æ–ø–µ—Ä–∞—Ü–∏–∏)
- –§–æ—Ç–æ–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ç–µ—Ä–∞–ø–∏—è: 10,500 —Ä—É–± –∑–∞ 5 –ø–æ—Å–µ—â–µ–Ω–∏–π (—Å–∫–∏–¥–∫–∞ 30%)
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≥—É–±: 15,000 —Ä—É–±
- –ë–æ—Ç—É–ª–æ—Ç–æ–∫—Å–∏–Ω: 250 —Ä—É–± –∑–∞ –µ–¥–∏–Ω–∏—Ü—É
- –ß–∏—Å—Ç–∫–∞ –ª–∏—Ü–∞ + –ø–∏–ª–∏–Ω–≥ BIOREPEEL + –§–æ—Ç–æ–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ç–µ—Ä–∞–ø–∏—è REVIXAN: 9,500 —Ä—É–±
- –ë–∏–æ—Ä–µ–≤–∏—Ç–∞–ª–∏–∑–∞—Ü–∏—è: 21,600 —Ä—É–± –∑–∞ 3 –∑–æ–Ω—ã
- –õ–∞–∑–µ—Ä–Ω–∞—è —ç–ø–∏–ª—è—Ü–∏—è (–∫–æ–º–ø–ª–µ–∫—Å): 6,850 —Ä—É–±
- –§–æ—Ç–æ–æ–º–æ–ª–æ–∂–µ–Ω–∏–µ LUMECCA: 6,000 —Ä—É–±
- –ö–∞–ø–µ–ª—å–Ω–∏—Ü—ã: –æ—Ç 5,000 —Ä—É–± (–ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ –∫—É—Ä—Å–∞ –æ—Ç 5 —à—Ç ‚Äî –ø–æ–¥–∞—Ä–æ–∫)
- –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –≤—Ä–∞—á–∞: 10,000 —Ä—É–± (Check-up + –±–∏–æ–∏–º–ø–µ–¥–∞–Ω—Å)

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∫–ª–∏–Ω–∏–∫–∏:
‚úì –ë–æ–ª–µ–µ 10 –ª–µ—Ç –æ–ø—ã—Ç–∞
‚úì –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –ª–∏—Ü–µ–Ω–∑–∏—è
‚úì –ö—Ä—É–ø–Ω–µ–π—à–∏–π –≤ –°–æ—á–∏ –ø–∞—Ä–∫ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –ø—Ä–µ–º–∏—É–º-–∫–ª–∞—Å—Å–∞
‚úì –°–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ –æ—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –¥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
‚úì –ê–¥—Ä–µ—Å: –°–æ—á–∏, —É–ª. –í–æ—Ä–æ–≤—Å–∫–æ–≥–æ, 22
‚úì –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ 10:00‚Äì20:00

–ö–∞–∫ —Å–æ–±–∏—Ä–∞—Ç—å –∑–∞—è–≤–∫–∏:
–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç—Å—è –ø—Ä–æ—Ü–µ–¥—É—Ä–æ–π –∏–ª–∏ —Ö–æ—á–µ—Ç –∑–∞–ø–∏—Å–∞—Ç—å—Å—è ‚Äî –ø–æ–ø—Ä–æ—Å–∏ –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω:
¬´–î–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –º–Ω–µ –Ω—É–∂–Ω–æ –≤–∞—à–µ –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑–∏. –£–∫–∞–∂–∏—Ç–µ –∏—Ö, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞.¬ª

–ö–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –¥–∞–ª –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–¥–∏:
¬´–°–ø–∞—Å–∏–±–æ! –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –ø–µ—Ä–µ–¥–∞–Ω–∞ –º–µ–Ω–µ–¥–∂–µ—Ä—É. –° –≤–∞–º–∏ —Å–≤—è–∂—É—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –º–∏–Ω—É—Ç.¬ª

–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã:
- ¬´–ï—Å—Ç—å –ª–∏ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è?¬ª ‚Äî –î–∞, –≤—Å–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏–º–µ—é—Ç –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è. –ù–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –≤—Ä–∞—á –ø—Ä–æ–≤–µ–¥–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É.
- ¬´–ö–∞–∫ –¥–æ–ª–≥–æ –¥–ª–∏—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç?¬ª ‚Äî –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π.
- ¬´–ï—Å—Ç—å –ª–∏ —Ä–∞—Å—Å—Ä–æ—á–∫–∞?¬ª ‚Äî –î–∞, –æ–±—Å—É–∂–¥–∞–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ.
- ¬´–ú–æ–∂–Ω–æ –ª–∏ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è —Å–µ–≥–æ–¥–Ω—è?¬ª ‚Äî –î–∞, –∑–≤–æ–Ω–∏—Ç–µ –∏–ª–∏ –æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –∑–∞—è–≤–∫—É.

–ù–µ –¥–∞–≤–∞–π –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π! –í—Å–µ–≥–¥–∞ –ø—Ä–µ–¥–ª–∞–≥–∞–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –≤—Ä–∞—á–∞.

–ó–∞–≤–µ—Ä—à–∞–π –¥–∏–∞–ª–æ–≥ –≤–µ–∂–ª–∏–≤–æ: ¬´–ë—É–¥—É —Ä–∞–¥–∞ –≤–∏–¥–µ—Ç—å –≤–∞—Å –≤ –Ω–∞—à–µ–π –∫–ª–∏–Ω–∏–∫–µ!¬ª
"""

def generate_bot_reply(api_key: str, message: str) -> str:
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ Replicate API."""
    try:
        print(f"\nü§ñ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ AI")
        print(f"   –°–æ–æ–±—â–µ–Ω–∏–µ: '{message}'")
        
        client = replicate.Client(api_token=api_key)
        
        full_prompt = f"""{SYSTEM_PROMPT}

–î–∏–∞–ª–æ–≥ —Å –∫–ª–∏–µ–Ω—Ç–æ–º:
–ö–ª–∏–µ–Ω—Ç: {message}

–¢–≤–æ–π –æ—Ç–≤–µ—Ç (–∫–∞–∫ –º–µ–Ω–µ–¥–∂–µ—Ä –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞):"""
        
        output = replicate.run(
            "meta/meta-llama-3-70b-instruct",
            input={
                "prompt": full_prompt,
                "max_tokens": 800,
                "temperature": 0.7,
                "top_p": 0.9
            }
        )
        
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—Ç–≤–µ—Ç
        result = ""
        if hasattr(output, '__iter__') and not isinstance(output, str):
            for chunk in output:
                if isinstance(chunk, str):
                    result += chunk
                else:
                    result += str(chunk)
        elif isinstance(output, str):
            result = output
        else:
            result = str(output)
        
        print(f"   –û—Ç–≤–µ—Ç AI: {result[:150]}...")
        
        return result.strip() if result.strip() else "–ò–∑–≤–∏–Ω–∏—Ç–µ, –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç."
            
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ AI: {str(e)}")
        return "–ò–∑–≤–∏–Ω–∏—Ç–µ, –≤–æ–∑–Ω–∏–∫–ª–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–∑–≤–æ–Ω–∏—Ç–µ –Ω–∞–º –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –≤ WhatsApp."

def check_interesting_application(text: str):
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –∑–∞—è–≤–∫–æ–π –Ω–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä—É.
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç True –µ—Å–ª–∏ –≤ —Ç–µ–∫—Å—Ç–µ –µ—Å—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä.
    """
    t = text.lower()
    
    # –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä –∏ –∑–∞–ø–∏—Å–∏
    procedure_keywords = [
        "smas", "–ª–∏—Ñ—Ç–∏–Ω–≥", "morpheus", "—Ñ–æ—Ç–æ–æ–º–æ–ª–æ–∂–µ–Ω–∏–µ", "–±–æ—Ç—É–ª–∏–Ω", "–±–æ—Ç–æ–∫—Å",
        "—ç–ø–∏–ª—è—Ü–∏—è", "–≥—É–±—ã", "–±–∏–æ—Ä–µ–≤–∏—Ç–∞–ª–∏–∑–∞—Ü–∏—è", "—á–∏—Å—Ç–∫–∞", "–ø–∏–ª–∏–Ω–≥", "–æ–º–æ–ª–æ–∂–µ–Ω–∏–µ",
        "—Ç–µ—Ä–∞–ø–∏—è", "–∫–∞–ø–µ–ª—å–Ω–∏—Ü—ã", "–∏–Ω—ä–µ–∫—Ü–∏—è", "—É–∫–æ–ª", "–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è", "–≤—Ä–∞—á",
        "–ø—Ä–∏–µ–º", "–∑–∞–ø–∏—Å—å", "–∑–∞–ø–∏—Å–∞—Ç—å—Å—è", "—Ü–µ–Ω–∞", "—Å—Ç–æ–∏–º–æ—Å—Ç—å", "—Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç",
        "–∞–∫—Ü–∏—è", "—Å–∫–∏–¥–∫–∞", "–ø—Ä–æ—Ü–µ–¥—É—Ä–∞", "—É–≤–µ–ª–∏—á–µ–Ω–∏–µ", "–∫–æ—Ä—Ä–µ–∫—Ü–∏—è", "–æ–º–æ–ª–æ–∂–µ–Ω–∏–µ"
    ]
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
    has_keywords = any(keyword in t for keyword in procedure_keywords)
    
    print(f"üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—è–≤–∫–∏: '{text[:50]}...'")
    print(f"   –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –Ω–∞–π–¥–µ–Ω—ã: {has_keywords}")
    
    return has_keywords
